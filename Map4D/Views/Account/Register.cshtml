@model Map4D.Models.RegisterViewModel
@{
    ViewBag.Title = "Đăng ký";
}
@section css{
    <link href="~/Content/Client/css/register.css" rel="stylesheet" />
    <link href="~/Content/sweetalert/css/sweetalert.min.css" rel="stylesheet" />
}
@using (Html.BeginForm("Register", "Account", FormMethod.Post, new { @class = "w-100" }))
{
    @Html.AntiForgeryToken()
    <div class="row registerUser">
        <h2 class="col-12 text-center">Đăng ký</h2>
        <div class="boxRegister col-lg-5 col-xl-4 col-md-6 col-sm-9 col-9">
            <div class="form-group">
                @Html.TextBoxFor(m => m.UserName, new { @class = "form-control input", @id = "txtUserName", @placeholder = "Tên đăng nhập" })
                @Html.ValidationMessageFor(m => m.UserName, "", new { @class = "text-danger" })
            </div>
            <div class="form-group">
                @Html.TextBoxFor(m => m.Email, new { @class = "form-control input", @id = "txtEmail", @placeholder = "Email" })
                @Html.ValidationMessageFor(m => m.Email, "", new { @class = "text-danger" })
            </div>
            <div class="form-group">
                @Html.TextBoxFor(m => m.Password, new { @class = "form-control input", @id = "txtPassword", @placeholder = "Mật khẩu", @type = "password" })
                @Html.ValidationMessageFor(m => m.Password, "", new { @class = "text-danger" })
            </div>
            <div class="form-group">
                <div class="divBottom">
                    <a class="col-6" href="/account/login">Đã có tài khoản</a>
                    <button type="submit" id="btnRegister" class="col-4 float-right btn">Đăng ký</button>
                </div>
            </div>
        </div>
    </div>
}
<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
                <p>Some text in the modal.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>

    </div>
</div>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/Content/sweetalert/js/sweetalert.min.js"></script>
    <script>
        $(document).ready(function () {
            var APILink = "@ViewBag.APIRegister";

            $('form').submit(function (e) {
                e.preventDefault();

                var attr = $('form input').hasClass("input-validation-error");
                if (!attr) {
                    $.ajax({
                        type: "post",
                        url: APILink + 'api/Account/Register',
                        dataType: "json",
                        data: {
                            UserName: $("#txtUserName").val(),
                            Email: $("#txtEmail").val(),
                            Password: $("#txtPassword").val(),
                        },
                        cache: false,
                        crossDomain: true,
                        processData: true,
                        success: function (data) {
                            if (data) {

                                swal({
                                    title: "Đăng ký thành công",
                                    text: "Vui lòng xác nhận Email",
                                    type: "success",
                                    confirmButtonClass: "btn-primary",
                                    confirmButtonText: "Xong",
                                    closeOnConfirm: false
                                }, function () {
                                    location.reload();
                                    });
                            }
                        }
                    });
                }

            });
        })
    </script>
}
