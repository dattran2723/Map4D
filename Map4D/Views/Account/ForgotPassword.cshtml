@model Map4D.Models.ForgotPasswordViewModel
@{
    ViewBag.Title = "Forgot your password?";
}
@section css{
    <link href="~/Content/Client/css/ForgotPassword.css" rel="stylesheet" />
}
<div class="forgot-password row w-100">
    <div class="form-forgot-password col-md-5 mx-auto">
        @using (Html.BeginForm("ForgotPassword", "Account", FormMethod.Post, new { @class = "", role = "form" }))
        {
            @Html.AntiForgeryToken()
            <h4>Recover password</h4>
            <div class="form-group">
                <div class="forgot-title">
                    <span class="col-6">Email@*<a class="red-star"> *</a>*@</span>
                </div>
                <div class="col-md-8 mx-auto">
                    @Html.TextBoxFor(m => m.Email, new { @class = "form-control", @autofocus = "@autofocus" })
                    @Html.ValidationMessageFor(m => m.Email, "", new { @class = "text-danger" })
                </div>
                <div class="col-md-8 mx-auto">
                    <input type="submit" id="btn-forgot" class="btn btn-default form-control" value="Sent reset instructions" />
                </div>
                <div class="col-md-8 mx-auto btn-register">
                    <a href="@Url.Action("Login","Account")">Sign in for Map4D  ></a>
                </div>

            </div>
        }
    </div>
</div>
@section scripts{
    <script src="~/Scripts/jquery.validate.min.js"></script>
    <script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/Scripts/js/sweetalert2.js"></script>
    @if (ViewBag.Message != null)
    {
        <script charset="UTF-8">
            $(document).ready(function () {
                var message = "@ViewBag.Message";
                if (message == "true") {
                    swal({
                        title: "Khôi phục mật khẩu",
                        html: true,
                        html: '<p class="text-success mb-0">Chúng tôi đã gửi một email cho bạn</p>' +
                            '<p class="text-success mb-0">Vui lòng truy cập email để tiến hành thiết lập mật khẩu mới</p>',
                        confirmButtonClass: "w-100",
                        confirmButtonColor: '#0CF8C8',
                        confirmButtonText: "Đồng ý",
                        allowOutsideClick: false,
                        showCloseButton: true,
                        closeOnConfirm: true
                        }).then((result) => {
                        if (result.value) {
                            var url = '@Url.Action("Login","Account")';
                                window.location.href = url.replace();
                        }
                    });
                }
                else {
                    if (message == "false") {
                        swal({
                            title: "Không thể khôi phục mật khẩu",
                            html: true,
                            html: '<p class="text-danger mb-0">Tài khoản chưa được xác nhận trước đó</p>' +
                                '<p class="text-danger mb-0">Vui lòng xác nhận tài khoản trước để thực hiện chức năng này</p>',
                            confirmButtonClass: "w-100",
                            confirmButtonColor: '#0CF8C8',
                            confirmButtonText: "Đồng ý",
                            allowOutsideClick: false,
                            showCloseButton: true,
                            closeOnConfirm: true
                        }).then((result) => {
                        if (result.value) {
                            var url = '@Url.Action("ForgotPassword", "Account")';
                                window.location.href = url.replace();
                        }
                    });
                    }
                    else
                    {
                         swal({
                            title: "Không thể khôi phục mật khẩu",
                            html: true,
                            html: '<p class="text-danger mb-0">Không có tài khoản nào được liên kết với email</p>' +
                                '<p class="text-danger mb-0"><b>iotlink.com.vn</b></p>' +
                                '<p class="text-danger mb-0">Vui lòng thử một email khác</p> ',
                            confirmButtonClass: "w-100",
                            confirmButtonColor: '#0CF8C8',
                            confirmButtonText: "Đồng ý",
                            allowOutsideClick: false,
                            showCloseButton: true,
                            closeOnConfirm: true
                        }).then((result) => {
                        if (result.value) {
                            var url = '@Url.Action("ForgotPassword", "Account")';
                                window.location.href = url.replace();
                        }
                    });
                    }
                }
            });

        </script>
    }
}
